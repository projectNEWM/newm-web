(self.webpackChunkyoroi=self.webpackChunkyoroi||[]).push([[7747],{47747:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Ht});var a=o(87672),r=o.n(a),n=o(70798),s=o(30381),i=o.n(s),l=o(67294),d=o(99095),c=o(60978),p=o(19896),h=o(35450),u=o(41449),g=o(26447),x=o(23972),m=o(69397),f=o(38043),w=o(64675),y=o(77766),v=o.n(y),j=o(32366),b=o.n(j),Z=o(66932);const k=e=>{const t=(0,Z.KT)(e,36,{padding:0});return`data:image/svg+xml;utf8,${encodeURIComponent(t)}`},C=e=>((e,t)=>b()(e).call(e,((e,o)=>{var a;return{...e,[o[t]]:v()(a=e[o[t]]||[]).call(a,o)}}),{}))(e,"poolName");var M=o(48521);const T=(0,d.injectIntl)((0,n.Pi)((function({delegatedPool:e,undelegate:t,intl:o,poolTransition:a,delegateToSpecificPool:r}){const{id:n,name:s,ticker:i,poolSize:l,share:d,avatar:c,roa:h,socialLinks:u,websiteUrl:m}=e||{},y=k(n);return(0,M.jsxs)(I,{sx:{border:"1px solid",borderColor:"grayscale.200",bgcolor:"ds.bg_color_max",paddingBottom:"24px"},children:[(0,M.jsxs)(g.Z,{direction:"row",px:4,py:2,alignItems:"center",children:[(0,M.jsx)(x.Z,{component:"div",variant:"h5",color:"ds.text_gray_medium",fontWeight:500,children:o.formatMessage(f.default.stakePoolDelegated)}),null!=a&&a.shouldShowTransitionFunnel?(0,M.jsx)(P,{variant:"danger",onClick:()=>{var e,t;return r(null!==(e=null===(t=a.suggestedPool)||void 0===t?void 0:t.hash)&&void 0!==e?e:"")},children:o.formatMessage(f.default.updatePool)}):(0,M.jsx)(E,{variant:"text",onClick:t,disabled:!t,sx:{lineHeight:"21px","&.MuiButton-sizeMedium":{height:"unset",p:"9px 15px"}},children:o.formatMessage(f.default.undelegateLabel)})]}),(0,M.jsx)(p.Z,{sx:{borderBottom:"1px solid",borderBottomColor:"grayscale.200",display:"flex",alignItems:"center",justifyContent:"space-between"}}),(0,M.jsxs)(R,{sx:{paddingBottom:0},children:[(0,M.jsx)(D,{children:null!=c?(0,M.jsx)(S,{src:c,alt:"stake pool logo"}):(0,M.jsx)(S,{src:y,alt:"stake pool logo"})}),(0,M.jsxs)(p.Z,{marginLeft:"16px",sx:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[(0,M.jsxs)(x.Z,{component:"div",color:"grayscale.max",variant:"body1",fontWeight:"medium",mb:"3px",children:[void 0!==i?`[${i}]`:""," ",s]}),(0,M.jsx)(w.K,{color:"grayscale.500",websiteUrl:m,socialLinks:u})]})]}),(0,M.jsxs)(R,{justifyContent:"space-between",sx:{paddingBottom:"25px"},children:[null!=h?(0,M.jsxs)(p.Z,{sx:{display:"flex",flexFlow:"column"},children:[(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"grayscale.500",sx:{textTransform:"uppercase"},children:o.formatMessage(f.default.roa30d)}),(0,M.jsxs)(x.Z,{as:"span",fontWeight:500,color:"grayscale.max",variant:"h2",children:[h," %"]})]}):null,null!=l&&(0,M.jsxs)(p.Z,{sx:{display:"flex",flexFlow:"column"},children:[(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"grayscale.500",sx:{textTransform:"uppercase"},children:o.formatMessage(f.default.poolSize)}),(0,M.jsx)(x.Z,{as:"span",fontWeight:500,color:"grayscale.max",variant:"h2",children:l})]}),null!=d&&(0,M.jsxs)(p.Z,{sx:{display:"flex",flexFlow:"column"},children:[(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"grayscale.500",sx:{textTransform:"uppercase"},children:o.formatMessage(f.default.poolSaturation)}),(0,M.jsxs)(x.Z,{as:"span",fontWeight:500,color:"grayscale.max",variant:"h2",children:[d," %"]})]})]})]})}))),I=(0,h.Z)(p.Z)({borderRadius:"8px",display:"flex",flexDirection:"column",justifyContent:"flex-end"}),R=(0,h.Z)(p.Z)({display:"flex",padding:24}),D=(0,h.Z)(p.Z)({width:"40px",height:"40px",minWidth:"40px",marginRight:"12px",borderRadius:"20px",overflow:"hidden"}),S=(0,h.Z)("img")({width:"100%",background:"white",objectFit:"scale-down"}),E=(0,h.Z)(m.Z)({minWidth:"auto",width:"unset",marginLeft:"auto"}),P=(0,h.Z)(m.Z)((({theme:e})=>({minWidth:"auto",width:"140px",marginLeft:"auto",background:e.palette.ds.sys_magenta_500,color:"white",height:"40px",padding:"0px !important",fontSize:"14px","&:hover":{backgroundColor:e.palette.ds.sys_magenta_500,color:"white"}})));var B=o(66489);function L({percentage:e,days:t,currentEpoch:o,startEpochDate:a,endEpochDate:r}){return(0,M.jsx)(p.Z,{children:(0,M.jsxs)(g.Z,{direction:"row",spacing:2,justifyContent:"flex-start",children:[(0,M.jsx)(O,{value:e,days:t}),(0,M.jsxs)(g.Z,{direction:"column",flexGrow:"1",children:[(0,M.jsx)(W,{label:"Current Epoch",value:o}),(0,M.jsxs)(g.Z,{direction:"row",spacing:3,mt:"50px",justifyContent:"space-between",children:[(0,M.jsx)(A,{label:"Epoch started at",value:a}),(0,M.jsx)(A,{label:"Epoch ends at",value:r})]})]})]})})}const W=({label:e,value:t})=>(0,M.jsx)(p.Z,{children:(0,M.jsxs)(x.Z,{component:"div",fontWeight:"500",color:"primary.600",children:[e,": ",t]})}),A=({label:e,value:t})=>(0,M.jsxs)(p.Z,{children:[(0,M.jsx)(x.Z,{component:"div",style:{textTransform:"uppercase"},variant:"caption",mb:"4px",color:"grayscale.600",children:e}),(0,M.jsx)(x.Z,{component:"div",color:"grayscale.900",children:t})]}),O=({value:e,days:t})=>(0,M.jsxs)(p.Z,{mr:"8px",position:"relative",display:"flex",justifyContent:"center",children:[(0,M.jsx)(B.Z,{size:120,thickness:7,variant:"determinate",value:e,sx:{color:"primary.600",animationDuration:"550ms",position:"absolute",zIndex:1}}),(0,M.jsx)(B.Z,{size:120,thickness:7,variant:"determinate",sx:{color:"ds.gray_100"},value:100}),(0,M.jsxs)(p.Z,{position:"absolute",sx:{top:"30%",left:"50%",transform:"translate(-50%)",textAlign:"center"},children:[(0,M.jsxs)(x.Z,{component:"div",variant:"h4",color:"grayscale.900",children:[e,"%"]}),(0,M.jsxs)(x.Z,{component:"div",variant:"caption1",fontSize:"12px",color:"grayscale.600",children:[t," days"]})]})]}),_=(0,d.injectIntl)((0,n.Pi)((function({epochProgress:e,intl:t}){const o=i()(e.endEpochDateTime).diff(i()(),"days");return(0,M.jsxs)(F,{sx:{border:"1px solid",borderColor:"grayscale.200",bgcolor:"ds.bg_color_max"},children:[(0,M.jsx)(p.Z,{sx:{padding:"15px 24px",borderBottom:"1px solid",borderColor:"grayscale.200"},children:(0,M.jsx)(x.Z,{component:"div",variant:"h5",color:"ds.text_gray_medium",fontWeight:500,children:t.formatMessage(f.default.epochProgress)})}),(0,M.jsx)(p.Z,{sx:{padding:"24px"},children:(0,M.jsx)(L,{percentage:e.percentage,days:o,currentEpoch:e.currentEpoch,startEpochDate:e.startEpochDate,endEpochDate:e.endEpochDate})})]})}))),F=(0,h.Z)(p.Z)({borderRadius:"8px",flex:"1 1 100%",display:"flex",flexDirection:"column"});var z,H,N=o(36094),q=o(67756),U=o(73891),G=o(55343),$=o(53380),Y=o(69051),K=o(62817),Q=o(28336),V=o(52065);const X=(0,d.defineMessages)({overviewContent:{id:"wallet.staking.overviewContent",defaultMessage:"!!!Your rewards are automatically staked. You donâ€™t need to withdraw it everytime because you pay a transaction fee."},availableTotalRewards:{id:"wallet.staking.availableTotalRewards",defaultMessage:"!!!Available Total Rewards"},availableTotalRewardsHelper:{id:"wallet.staking.availableTotalRewardsHelper",defaultMessage:"!!!If the Reward amount is different than expected, see possible reasons of that on our {faqLink}."},FAQPage:{id:"wallet.staking.FAQPage",defaultMessage:"!!!FAQ page"}});let J=(0,n.Pi)((H=class extends l.Component{constructor(...e){super(...e),r()(this,"formatTokenEntry",(e=>{const t=this.props.getTokenInfo(e),o=e.amount.shiftedBy(-t.Metadata.numberOfDecimals).toFormat(t.Metadata.numberOfDecimals).split("."),a=this.props.shouldHideBalance?K.G:(0,M.jsxs)(M.Fragment,{children:[o[0],(0,M.jsxs)("span",{children:[".",o[1]," "]})]});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("span",{children:[a," "]}),(0,Q.truncateToken)((0,V.getTokenName)(t))]})})),r()(this,"renderAmount",(e=>null==e?(0,M.jsx)("div",{className:$.Z.loadingSpinner,children:(0,M.jsx)(Y.default,{small:!0})}):this.formatTokenEntry(e.getDefaultEntry()))),r()(this,"renderAmountWithUnitOfAccount",(e=>{if(null==e)return null;const t=this.props.unitOfAccount(e.getDefaultEntry());return t?this.props.shouldHideBalance?`${K.G}  ${t.currency}`:`${t.amount} ${t.currency}`:null}))}render(){const{intl:e}=this.context,{withdrawRewards:t,onClose:o,totalRewards:a}=this.props,r=[{label:e.formatMessage(f.default.backButtonLabel),onClick:()=>o(),disabled:!1},{label:e.formatMessage(f.default.withdrawLabel),primary:!0,onClick:()=>null==t?void 0:t(),disabled:null==t}],n=(0,M.jsx)(U.Z,{href:"https://emurgohelpdesk.zendesk.com",target:"_blank",rel:"noreferrer noopener",sx:{color:"inherit",textDecoration:"underline"},children:e.formatMessage(X.FAQPage)});return(0,M.jsxs)(N.ZP,{title:this.context.intl.formatMessage(f.default.overview),actions:r,closeOnOverlayClick:!1,closeButton:(0,M.jsx)(q.Z,{onClose:o}),onClose:o,children:[(0,M.jsx)(x.Z,{component:"div",color:"var(--yoroi-palette-gray-900)",children:e.formatMessage(X.overviewContent)}),(0,M.jsxs)(p.Z,{display:"flex",alignItems:"center",py:"50px",children:[(0,M.jsxs)(p.Z,{display:"flex",alignItems:"center",flex:"1",children:[(0,M.jsx)(x.Z,{component:"div",mr:"6px",children:e.formatMessage(X.availableTotalRewards)}),(0,M.jsx)(w.y,{message:(0,M.jsx)(d.FormattedMessage,{...X.availableTotalRewardsHelper,values:{faqLink:n}})})]}),(0,M.jsxs)(p.Z,{flex:"1",children:[(0,M.jsx)(x.Z,{component:"div",variant:"h1",fontWeight:"400",color:"var(--yoroi-palette-gray-900)",children:this.renderAmount(a)}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"var(--yoroi-palette-gray-900)",children:this.renderAmountWithUnitOfAccount(a)})]})]})]})}},r()(H,"contextTypes",{intl:d.intlShape.isRequired}),z=H))||z;var ee=o(26295),te=o.n(ee),oe=o(2991),ae=o.n(oe),re=o(20116),ne=o.n(re),se=o(2734),ie=o(99226),le=o(99716),de=o(90992),ce=o(82164),pe=o(86532),he=o(61250),ue=o(63083);const ge=()=>(0,M.jsx)("svg",{width:"14",height:"8",viewBox:"0 0 14 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,M.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.292893 0.292893C0.683417 -0.0976311 1.31658 -0.0976311 1.70711 0.292893L7 5.58579L12.2929 0.292893C12.6834 -0.0976311 13.3166 -0.0976311 13.7071 0.292893C14.0976 0.683417 14.0976 1.31658 13.7071 1.70711L7.70711 7.70711C7.31658 8.09763 6.68342 8.09763 6.29289 7.70711L0.292893 1.70711C-0.0976311 1.31658 -0.0976311 0.683417 0.292893 0.292893Z",fill:"#6B7384"})}),xe=(0,h.Z)((e=>(0,M.jsx)(pe.Z,{TransitionProps:{timeout:{exit:500}},disableGutters:!0,elevation:0,square:!0,...e})))((({theme:e})=>({backgroundColor:e.palette.ds.bg_color_max,borderBottom:e.palette.ds.bg_color_max,"&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},paddingBottom:"16px",marginBottom:"16px"}))),me=(0,h.Z)((e=>(0,M.jsx)(he.Z,{expandIcon:(0,M.jsx)(ge,{}),...e})))((()=>({padding:0,alignItems:"flex-start",".MuiAccordionSummary-expandIconWrapper":{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},".MuiAccordionSummary-content":{margin:0},"& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(180deg)"},"& .MuiCollapse-vertical":{transitionDuration:"0.5s"}}))),fe=(0,h.Z)(ue.Z)((()=>({marginTop:"24px",padding:0}))),we=({poolId:e,poolName:t,poolAvatar:o,historyList:a})=>{const r=k(e||t);return(0,M.jsxs)(xe,{children:[(0,M.jsx)(me,{"aria-controls":e+"-content",id:e||t+"-header",children:(0,M.jsxs)(p.Z,{children:[(0,M.jsx)(p.Z,{display:"block",children:(0,M.jsx)(x.Z,{component:"div",color:"ds.text_gray_low",children:"Stake Pool"})}),(0,M.jsxs)(p.Z,{display:"flex",children:[(0,M.jsx)(ye,{children:(0,M.jsx)(ve,{src:null!=o?o:r,alt:"stake pool logo"})}),(0,M.jsx)(x.Z,{component:"div",children:t})]})]})}),(0,M.jsx)(fe,{children:(0,M.jsx)(g.Z,{spacing:"22px",children:ae()(a).call(a,(({type:e,date:t,balance:o},a)=>(0,M.jsxs)(p.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,M.jsxs)(p.Z,{children:[(0,M.jsx)(x.Z,{component:"div",mb:"2px",color:"ds.text_gray_low",children:e}),(0,M.jsx)(x.Z,{component:"div",variant:"body2",color:"ds.text_gray_low",children:t})]}),(0,M.jsxs)(x.Z,{component:"div",fontWeight:500,variant:"body2",color:"ds.text_gray_medium",children:["+ ",o]})]},a)))})})]})};(0,d.injectIntl)((function({graphData:e,onOpenRewardList:t,intl:o}){var a;const r=e.items,n=(0,l.useMemo)((()=>C(r)),[]);return(0,M.jsxs)(p.Z,{children:[(0,M.jsx)(x.Z,{as:"button",variant:"body2",color:"var(--yoroi-palette-gray-600)",display:"block",marginLeft:"auto",onClick:t,children:o.formatMessage(f.default.openRewardHistory)}),e.error&&(0,M.jsxs)("div",{children:[(0,M.jsx)("center",{children:(0,M.jsx)(le.r,{})}),(0,M.jsx)(de.Z,{error:e.error})]}),null==r?(0,M.jsx)(ce.Z,{children:(0,M.jsx)(Y.default,{})}):ae()(a=te()(null!=n?n:{})).call(a,(([e,t])=>(0,M.jsx)(we,{poolId:t.poolId,poolName:e,poolAvatar:t.poolAvatar,historyList:ae()(t).call(t,(e=>({type:"Received",date:e.date,balance:e.primary})))},e)))]})}));const ye=(0,h.Z)(p.Z)({width:"24px",height:"24px",minWidth:"24px",marginRight:"12px",borderRadius:"20px",overflow:"hidden"}),ve=(0,h.Z)("img")({width:"100%",background:"white",objectFit:"scale-down"});o(63139);const je=(0,d.defineMessages)({epoch:{id:"wallet.staking.rewards.rewardHistory.epochNum",defaultMessage:"!!!Epoch {number}"}}),be=(0,d.injectIntl)((0,n.Pi)((function({graphData:e,onClose:t,intl:o}){var a,r,n;const s=e.rewardsGraphData.items,i=null!==(a=null==s?void 0:ne()(r=s.perEpochRewards).call(r,(e=>Boolean(e.primary))))&&void 0!==a?a:[],d=(0,l.useMemo)((()=>C(i)),[]),{palette:c}=(0,se.Z)();return(0,M.jsx)(N.ZP,{title:o.formatMessage(f.default.rewardHistory),closeOnOverlayClick:!1,closeButton:(0,M.jsx)(q.Z,{onClose:t}),onClose:t,styleContentOverride:{background:c.ds.bg_color_max},children:(0,M.jsxs)(ie.Z,{maxWidth:"600px",children:[(0,M.jsxs)(x.Z,{component:"div",mb:"24px",variant:"body1",fontWeight:500,color:"ds.text_gray_medium",children:[o.formatMessage(f.default.rewardsListLabel)," (",i.length,")"]}),(0,M.jsxs)(ie.Z,{children:[e.rewardsGraphData.error&&(0,M.jsxs)("div",{children:[(0,M.jsx)("center",{children:(0,M.jsx)(le.r,{})}),(0,M.jsx)(de.Z,{error:e.rewardsGraphData.error})]}),null==i?(0,M.jsx)(ce.Z,{children:(0,M.jsx)(Y.default,{})}):ae()(n=te()(null!=d?d:{})).call(n,(([e,t])=>(0,M.jsx)(we,{poolId:t.poolId,poolName:e||"-",poolAvatar:t.poolAvatar,historyList:ae()(t).call(t,(e=>({type:o.formatMessage(je.epoch,{number:e.name}),date:e.date,balance:e.primary,currency:e.currency})))},e)))]})]})})})));var Ze,ke,Ce,Me,Te;function Ie(){return Ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},Ie.apply(this,arguments)}function Re(e){return l.createElement("svg",Ie({width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Ze||(Ze=l.createElement("rect",{width:40,height:40,rx:20,fill:"#E4E8F7"})),ke||(ke=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27 17a7 7 0 10-14 0 7 7 0 0014 0zm-12 0a5 5 0 1110 0 5 5 0 01-10 0z",fill:"#3154CB"})),Ce||(Ce=l.createElement("path",{d:"M13.832 23.555a1 1 0 00-1.664-1.11l-1.992 2.99a.996.996 0 00-.063 1.026.993.993 0 00.574.489.996.996 0 00.328.05h2.867l1.216 2.433a.993.993 0 00.846.566 1.002 1.002 0 00.897-.457l1.991-2.987a1 1 0 00-1.664-1.11l-1.044 1.567-.719-1.438a1.004 1.004 0 00-.926-.574h-1.61l.963-1.445zM26.445 22.168a1 1 0 00-.277 1.387L27.132 25h-1.61a1.004 1.004 0 00-.925.571l-.72 1.44-1.045-1.566a1 1 0 00-1.664 1.11l1.99 2.986a.997.997 0 001.304.346.996.996 0 00.44-.454L26.118 27h2.867a.996.996 0 00.903-.539.995.995 0 00-.063-1.027l-1.993-2.989a1 1 0 00-1.387-.277z",fill:"#3154CB"})))}function De(){return De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},De.apply(this,arguments)}function Se(e){return l.createElement("svg",De({width:40,height:40,viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Me||(Me=l.createElement("rect",{width:40,height:40,rx:20,fill:"#E4F7F3"})),Te||(Te=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 11a7 7 0 00-2.25 13.63c.8.907 1.83 1.604 3 2a7 7 0 107.5-11.261 7.008 7.008 0 00-3-2A6.983 6.983 0 0017 11zm4.372 4.19a5 5 0 00-5.283 7.924 7.003 7.003 0 015.283-7.924zM13 20c0 .38.03.752.088 1.114a5 5 0 015.283-7.924A7.003 7.003 0 0013 20zm15 2a5 5 0 11-10 0 5 5 0 0110 0z",fill:"#0CDDB3"})))}o.p,o.p;var Ee=o(41511),Pe=o.n(Ee),Be=o(3649),Le=o.n(Be),We=o(29009),Ae=o(94831),Oe=o(3023),_e=o(75358),Fe=o(21738),ze=o(53237);const He="14px",Ne=e=>{const{hideYAxis:t,data:o,xAxisLabel:a,yAxisLabel:r,primaryBarLabel:n,epochTitle:s,stakepoolNameTitle:i}=e,l=({active:e,payload:t,label:o})=>{if(e&&null!=t){var a;const{poolName:e}=t[0].payload,r=[[s,o],[n,t[0].value],e?[i,e]:[]];return(0,M.jsx)(ie.Z,{sx:{padding:"8px 12px 8px 8px",bgcolor:e=>e.palette.ds.gray_900,color:"ds.bg_color_max",lineHeight:"14px",borderRadius:"4px"},children:ae()(a=ne()(r).call(r,(e=>null!==e&&e.length>0))).call(a,(([e,t],o)=>(0,M.jsxs)(g.Z,{direction:"row",mb:"2px",children:[(0,M.jsxs)(x.Z,{component:"div",width:2===o?"100px":"content",mr:"3px",variant:"caption1",children:[e,":"]}),(0,M.jsx)(x.Z,{component:"div",sx:{wordWrap:"break-word",maxWidth:"300px"},variant:"caption1",fontWeight:"bold",children:t})]})))})}return null},d=(0,M.jsx)(l,{});return(0,M.jsx)(We.h,{width:"100%",height:210,children:(0,M.jsxs)(Ae.v,{data:Le()(o).call(o,-10),height:200,margin:{top:0,right:0,left:56,bottom:0},children:[(0,M.jsx)(Oe.K,{tick:{fill:"#6B7384",fontSize:He,lineHeight:16},dataKey:"name",height:50,label:{value:a,position:"insideBottom",fontSize:"12px",fill:"#6B7384",offset:10},padding:{left:24,right:24},stroke:"#DCE0E9",tickLine:!1}),(0,M.jsx)(_e.B,{tickFormatter:e=>t?"âˆ—âˆ—âˆ—â€€":e,padding:{top:12},tick:{fill:"#6B7384",fontSize:He,lineHeight:16},stroke:"#DCE0E9",tickLine:!1,label:{value:r,position:"insideLeft",offset:15,dy:50,angle:-90,fill:"#6B7384",textAnchor:"middle",fontSize:"12px",fontWeight:400}}),(0,M.jsx)(Fe.u,{content:d,cursor:!1}),(0,M.jsx)(ze.$,{name:n,maxBarSize:10,radius:[4,4,0,0],dataKey:"primary",stackId:"a",fill:"#3154CB"})]})})},qe=((0,h.Z)((e=>(0,M.jsx)(pe.Z,{TransitionProps:{timeout:{exit:500}},disableGutters:!0,elevation:0,square:!0,...e})))((()=>({borderBottom:"1px solid var(--yoroi-palette-gray-50)","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},paddingBottom:"16px",marginBottom:"16px"}))),(0,h.Z)(ue.Z)((()=>({marginTop:"24px",padding:0}))),(0,h.Z)("img")({width:"100%",background:"white",objectFit:"scale-down"}),(0,h.Z)(p.Z)({width:"24px",height:"24px",minWidth:"24px",marginRight:"12px",borderRadius:"20px",overflow:"hidden"}),()=>(0,M.jsx)("svg",{width:"14",height:"8",viewBox:"0 0 14 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,M.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.292893 0.292893C0.683417 -0.0976311 1.31658 -0.0976311 1.70711 0.292893L7 5.58579L12.2929 0.292893C12.6834 -0.0976311 13.3166 -0.0976311 13.7071 0.292893C14.0976 0.683417 14.0976 1.31658 13.7071 1.70711L7.70711 7.70711C7.31658 8.09763 6.68342 8.09763 6.29289 7.70711L0.292893 1.70711C-0.0976311 1.31658 -0.0976311 0.683417 0.292893 0.292893Z",fill:"#6B7384"})}));(0,h.Z)((e=>(0,M.jsx)(he.Z,{expandIcon:(0,M.jsx)(qe,{}),...e})))((()=>({padding:0,".MuiAccordionSummary-content":{margin:0},"& .MuiAccordionSummary-expandIconWrapper.Mui-expanded":{transform:"rotate(180deg)"},"& .MuiCollapse-vertical":{transitionDuration:"0.5s"}})));const Ue=(0,d.injectIntl)((function({graphData:e,onOpenRewardList:t,intl:o}){var a;const{rewardsGraphData:r}=e,n=null===(a=r.items)||void 0===a?void 0:a.perEpochRewards,s=o.formatMessage(f.default.rewardHistory);return(0,M.jsxs)(p.Z,{p:"24px",sx:{display:"flex",flexFlow:"column",justifyContent:"space-between"},children:[(0,M.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",fontWeight:500,children:s}),(0,M.jsx)(m.Z,{color:"primary",size:"medium",onClick:t,sx:{lineHeight:"21px"},children:s})]}),r.error&&(0,M.jsxs)("div",{children:[(0,M.jsx)("center",{children:(0,M.jsx)(le.r,{})}),(0,M.jsx)(de.Z,{error:r.error})]}),Pe()(n)?(0,M.jsx)(p.Z,{ml:"-50px",children:(0,M.jsx)(Ne,{epochTitle:o.formatMessage(f.default.epochLabel),stakepoolNameTitle:o.formatMessage(f.default.stakepoolNameLabel),xAxisLabel:o.formatMessage(f.default.epochs),yAxisLabel:o.formatMessage(f.default.rewardValue),primaryBarLabel:o.formatMessage(f.default.rewardsLabel),data:n,hideYAxis:r.hideYAxis})}):(0,M.jsx)(ce.Z,{children:(0,M.jsx)(Y.default,{})})]})}));var Ge=o(90649);const $e=(0,d.defineMessages)({summary:{id:"wallet.staking.summary",defaultMessage:"!!!Rewards Summary"},dialogSummaryDescription:{id:"wallet.staking.dialogSummaryDescription",defaultMessage:"!!!Your rewards are automatically staked. You donâ€™t need to withdraw it everytime because you pay a transaction fee."}}),Ye=(0,d.injectIntl)((0,n.Pi)((function({totalRewards:e,totalDelegated:t,getTokenInfo:o,onOverviewClick:a,withdrawRewards:r,shouldHideBalance:n,onOpenRewardList:s,unitOfAccount:i,graphData:l,intl:d}){const c=e=>(0,Ge.maybe)(e,(e=>(e=>{const t=o(e),a=e.amount.shiftedBy(-t.Metadata.numberOfDecimals).toFormat(t.Metadata.numberOfDecimals).split("."),r=n?(0,M.jsx)(M.Fragment,{children:K.G}):(0,M.jsxs)(M.Fragment,{children:[a[0],(0,M.jsxs)("span",{children:[".",a[1]," "]})]});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("span",{children:[r," "]}),(0,Q.truncateToken)((0,V.getTokenName)(t))]})})(e.getDefaultEntry()))),h=e=>{const t=(0,Ge.maybe)(e,(e=>i(e.getDefaultEntry())));return(0,Ge.maybe)(t,(e=>`${n?K.G:e.amount} ${e.currency}`))};return(0,M.jsxs)(Ke,{sx:{border:"1px solid",borderColor:"grayscale.200",bgcolor:"ds.bg_color_max"},children:[(0,M.jsxs)(p.Z,{sx:{padding:"15px 24px",borderBottom:"1px solid",borderColor:"grayscale.200",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,M.jsx)(x.Z,{component:"div",variant:"h5",color:"ds.text_gray_medium",fontWeight:500,children:d.formatMessage($e.summary)}),(0,M.jsx)(m.Z,{variant:"primary",sx:{"&.MuiButton-sizeMedium":{height:"unset",p:"9px 20px"}},onClick:r,disabled:!r,children:d.formatMessage(f.default.withdrawLabel)})]}),(0,M.jsxs)(p.Z,{sx:{display:"flex"},children:[(0,M.jsxs)(Qe,{sx:{borderColor:"grayscale.200"},children:[(0,M.jsx)(Re,{}),(0,M.jsx)(Ve,{children:(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"grayscale.600",sx:{textTransform:"uppercase"},children:d.formatMessage(f.default.totalRewardsLabel)})}),(0,M.jsxs)(Ve,{children:[(0,M.jsx)(x.Z,{component:"div",variant:"h2",color:"ds.text_gray_medium",fontWeight:500,children:c(e)}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",fontWeight:500,children:h(e)})]})]}),(0,M.jsxs)(Qe,{sx:{borderColor:"grayscale.200"},children:[(0,M.jsx)(Se,{}),(0,M.jsx)(Ve,{children:(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"grayscale.600",marginBottom:"4px",sx:{textTransform:"uppercase"},children:d.formatMessage(f.default.totalDelegated)})}),(0,M.jsxs)(Ve,{children:[t?(0,M.jsx)(x.Z,{component:"div",variant:"h2",fontWeight:"500",color:"ds.text_gray_medium",children:c(t)}):(0,M.jsx)("div",{className:$.Z.loadingSpinner,children:(0,M.jsx)(Y.default,{small:!0})}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",fontWeight:500,children:h(t)})]})]})]}),(0,M.jsx)(Ue,{onOpenRewardList:s,graphData:l})]})}))),Ke=(0,h.Z)(p.Z)({borderRadius:"8px",flex:"1 1 48.5%",maxWidth:"48.5%"}),Qe=(0,h.Z)(p.Z)({width:"100%",padding:24,margin:"0",display:"flex",flexFlow:"column",borderStyle:"solid",borderBottomWidth:"1px",gap:8,"&:not(:first-child)":{borderLeftWidth:"1px"}}),Ve=(0,h.Z)(p.Z)({});(0,h.Z)(m.Z)({marginLeft:"auto",minWidth:"auto",width:"auto"});var Xe=o(9001),Je=o(16544),et=o(82463),tt=o(21603),ot=o(65528),at=o(81783),rt=o(90948),nt=o(5227);const st=(0,d.defineMessages)({title:{id:"governance.participateDialog.title",defaultMessage:"!!!Withdraw warning"},contentInfo:{id:"governance.participateDialog.contentInfo",defaultMessage:"!!!To withdraw your rewards, you need to participate in the Cardano Governance. Your rewards will continue to accumulate, but you are only able to withdraw it once you join the Governance process."},buttonText:{id:"governance.participateDialog.buttonText",defaultMessage:"!!!Participate on governance"}}),it=({onClose:e,actions:t,intl:o})=>(0,M.jsxs)(N.ZP,{onClose:e,title:o.formatMessage(st.title),styleOverride:{width:"648px",height:"240px",padding:0},styleContentOverride:{padding:0},closeOnOverlayClick:!0,closeButton:(0,M.jsx)(q.Z,{}),children:[(0,M.jsx)(x.Z,{variant:"body1",mb:2,mx:"24px",children:o.formatMessage(st.contentInfo)}),(0,M.jsx)(lt,{variant:"contained",color:"primary",width:"100%",onClick:()=>{e(),t.router.goToRoute.trigger({route:nt.ROUTES.Governance.ROOT})},sx:{marginTop:"12px"},children:o.formatMessage(st.buttonText)})]}),lt=(0,rt.ZP)(m.Z)((({_theme:e,_color:t})=>({width:"100%",fontSize:"16px",marginLeft:"24px",marginRight:"24px",maxWidth:"600px"})));var dt,ct,pt=o(61509),ht=o(34074),ut=o.n(ht),gt=o(89400),xt=o.n(gt),mt=o(5838),ft=o.n(mt),wt=o(89749),yt=o.n(wt),vt=(o(18293),o(22188)),jt=o(98900),bt=o(95667),Zt=o(27372),kt=(o(52298),o(58201)),Ct=o(52227),Mt=o(94687),Tt=o(65990),It=o(79846);function Rt(){return Rt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},Rt.apply(this,arguments)}function Dt(e){return l.createElement("svg",Rt({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),dt||(dt=l.createElement("path",{d:"M12 7a1 1 0 100 2h.01a1 1 0 100-2H12zM12 10a1 1 0 00-1 1v5a1 1 0 102 0v-5a1 1 0 00-1-1z",fill:"#ECBA09"})),ct||(ct=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12zm10-8a8 8 0 100 16 8 8 0 000-16z",fill:"#ECBA09"})))}function St({children:e}){return(0,M.jsxs)(ie.Z,{sx:{p:"12px 15px 16px 16px",width:"100%",backgroundColor:e=>e.palette.ds.sys_yellow_100,borderRadius:"8px"},children:[(0,M.jsxs)(ie.Z,{sx:{display:"flex",alignItems:"center",gap:"8px",mb:"8px"},children:[(0,M.jsx)(Dt,{}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",fontWeight:500,color:e=>e.palette.ds.sys_yellow_500,sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,M.jsx)(d.FormattedMessage,{...f.default.attentionTitle})})]}),e]})}o.p,St.defaultProps={children:void 0};var Et,Pt,Bt,Lt,Wt=o(84174);const At=(0,d.defineMessages)({dialogTitle:{id:"wallet.withdrawRewards.transaction.title",defaultMessage:"!!!Withdraw reward"},withdrawalAddress:{id:"wallet.withdrawRewards.transaction.address",defaultMessage:"!!!Withdrawal address"},accumulatedRewards:{id:"wallet.withdrawRewards.transaction.accumulatedRewards",defaultMessage:"!!!Accumulated Rewards"},deregistrationWarning:{id:"wallet.undelegation.transaction.warning",defaultMessage:"!!!Your rewards will automatically get withdrawn once you undelegate from a stake pool. You will also receive back your staking deposit of 2 ADA. If you wish to choose another stake pool, you can change your preference without undelegation."},undelegateAnyway:{id:"wallet.undelegation.transaction.button.label",defaultMessage:"!!!Undelegate anyway"}});let Ot=(0,n.Pi)((Lt=class extends l.Component{constructor(...e){super(...e),ft()(this,"spendingPasswordForm",Bt,this),r()(this,"submit",(async()=>{const e=this.props.stores.wallets.selected;if(null==e)throw new Error("WithdrawRewardsDialog no wallet selected");const t=this.props.stores.substores.ada.delegationTransaction.createWithdrawalTx.result;null!=t&&(null==this.spendingPasswordForm?("trezor"===e.type&&await this.props.actions.ada.trezorSend.sendUsingTrezor.trigger({params:{signRequest:t},wallet:e}),"ledger"===e.type&&await this.props.actions.ada.ledgerSend.sendUsingLedgerWallet.trigger({params:{signRequest:t},wallet:e})):this.spendingPasswordForm.submit({onSuccess:async o=>{const{walletPassword:a}=xt()(o).call(o);await this.props.actions.wallets.sendMoney.trigger({signRequest:t,password:a,wallet:e})},onError:()=>{}}))})),r()(this,"getTotalBalance",((e,t,o)=>{const a=e.joinSubtractCopy(t);if(null==o)return a;const r=b()(o).call(o,((e,t)=>null==t.refund?e:e.joinAddCopy(t.refund)),new G.a([],e.defaults));return a.joinAddCopy(r)}))}setSpendingPasswordForm(e){this.spendingPasswordForm=e}componentWillUnmount(){this.props.stores.wallets.sendMoneyRequest.reset(),this.props.stores.substores.ada.delegationTransaction.createWithdrawalTx.reset(),this.props.actions.ada.ledgerSend.cancel.trigger(),this.props.actions.ada.trezorSend.cancel.trigger()}render(){var e,t;const{intl:o}=this.context,a=this.props.stores.wallets.selected;if(null==a)throw new Error("WithdrawRewardsDialog no public deriver. Should never happen");const r=this.props.stores.delegation.getDelegatedPoolId(a.publicDeriverId);if(null==r)return null;const n=(0,Wt.getNetworkById)(a.networkId),s=this.props.stores.delegation.getLocalPoolInfo(a.networkId,String(r));if(null==s)return null;const i=null!==(e=null===(t=s.info)||void 0===t?void 0:t.name)&&void 0!==e?e:o.formatMessage(f.default.unknownPoolLabel),l=(0,Z.KT)(r,36,{padding:0}),d=`data:image/svg+xml;utf8,${encodeURIComponent(l)}`,{createWithdrawalTx:c,shouldDeregister:p}=this.props.stores.substores.ada.delegationTransaction;if(null==this.props.stores.profile.selectedNetwork)throw new Error("WithdrawRewardsDialog no selected network");const h=this.props.stores.tokenInfoStore.getDefaultTokenInfo(this.props.stores.profile.selectedNetwork.NetworkId),u=(0,V.getTokenName)(h),g=(0,V.genFormatTokenAmount)((0,V.genLookupOrFail)(this.props.stores.tokenInfoStore.tokenInfo));if(null!=c.error)return(0,M.jsx)(Mt.Z,{error:c.error,onCancel:this.props.onClose,classicTheme:!1});const m=c.result;if(!m)return(0,M.jsx)(N.ZP,{title:o.formatMessage(f.default.processingLabel),closeOnOverlayClick:!1,children:(0,M.jsx)(ie.Z,{width:"350px",children:(0,M.jsx)(Ct.Z,{children:(0,M.jsx)(ce.Z,{children:(0,M.jsx)(Y.default,{})})})})});const w=m.receivers(!0),y=(0,bt.addressToDisplayString)(w[0],n),v=m.withdrawals(),j=m.keyDeregistrations(),k=b()(v).call(v,((e,t)=>e.joinAddCopy(t.amount)),new G.a([],(0,Zt.A$)(h))),C=m.fee(),T=this.getTotalBalance(k,C,j),I=this.props.stores.wallets.sendMoneyRequest.isExecuting,R=this.props.stores.wallets.sendMoneyRequest.error,D="mnemonic"!==a.type?void 0:(0,M.jsx)(kt.Z,{setForm:e=>this.setSpendingPasswordForm(e),classicTheme:!1,isSubmitting:I}),S=this.props.stores.explorers.selectedExplorer.get(a.networkId);if(!S)throw new Error("No explorer for wallet network");return(0,M.jsx)(N.ZP,{title:o.formatMessage(At.dialogTitle),actions:[{label:o.formatMessage(f.default.cancel),onClick:this.props.onClose},{label:o.formatMessage(p?At.undelegateAnyway:f.default.confirm),onClick:this.submit,primary:!0,isSubmitting:I}],closeOnOverlayClick:!1,onClose:this.props.onClose,closeButton:(0,M.jsx)(q.Z,{}),scrollableContentClass:"WithdrawRewards",styleOverride:{width:"648px"},children:(0,M.jsxs)(ie.Z,{className:"WithdrawRewards",overflowY:"auto",maxHeight:"70vh",maxWidth:"604px",children:[p&&(0,M.jsx)(ie.Z,{mb:"24px",children:(0,M.jsx)(St,{children:(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"ds.text_gray_medium",children:o.formatMessage(At.deregistrationWarning)})})}),(0,M.jsxs)(ie.Z,{mb:"16px",px:"5px",children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",children:o.formatMessage(f.default.stakePoolChecksumAndName)}),(0,M.jsxs)(ie.Z,{sx:{display:"flex",alignItems:"center",gap:"8px",mt:"4px"},children:[(0,M.jsx)(ie.Z,{children:(0,M.jsx)(ie.Z,{sx:{width:"24px",height:"24px",borderRadius:"50%",display:"inline-block"},component:"img",src:d})}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.900",children:i})]})]}),(0,M.jsxs)(ie.Z,{children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",px:"4px",children:o.formatMessage(f.default.stakePoolHash)}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",sx:{"& > div > p":{p:"2px 3px"},px:"2px"},children:(0,M.jsx)(jt.g,{text:r,children:(0,M.jsx)(Tt.Z,{selectedExplorer:S,hash:r,light:!0,primary:!0,linkType:"pool",placementTooltip:"top",children:(0,M.jsx)(It.Z,{light:!0,primary:!0,children:r})})})})]}),(0,M.jsxs)(ie.Z,{children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",px:"5px",children:o.formatMessage(At.withdrawalAddress)}),(0,M.jsx)(x.Z,{component:"div",variant:"body1",sx:{"& > div > p":{p:"2px 3px"},px:"2px"},children:(0,M.jsx)(jt.g,{text:y,children:(0,M.jsx)(Tt.Z,{selectedExplorer:S,hash:y,light:!0,primary:!0,linkType:"address",children:(0,M.jsx)(It.Z,{light:!0,primary:!0,children:(0,Q.truncateAddress)(y)})})})})]}),(0,M.jsxs)(ie.Z,{display:"flex",gap:"16px",justifyContent:"space-between",pt:"24px",mt:"28px",mx:"5px",borderTop:"1px solid",borderColor:"grayscale.200",children:[(0,M.jsxs)(ie.Z,{minWidth:"180px",children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",mb:"4px",children:o.formatMessage(At.accumulatedRewards)}),(0,M.jsxs)(x.Z,{component:"div",variant:"body1",color:"grayscale.900",children:[g(k.getDefaultEntry())," ",u]})]}),(0,M.jsxs)(ie.Z,{minWidth:"180px",children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",mb:"4px",children:o.formatMessage(f.default.feeLabel)}),(0,M.jsxs)(x.Z,{component:"div",variant:"body1",color:"grayscale.900",children:[g(C.getDefaultEntry())," ",u]})]}),(0,M.jsxs)(ie.Z,{minWidth:"180px",children:[(0,M.jsx)(x.Z,{component:"div",variant:"body1",color:"grayscale.600",mb:"4px",children:o.formatMessage(f.default.finalBalanceLabel)}),(0,M.jsxs)(x.Z,{component:"div",variant:"body1",color:"grayscale.900",children:[g(T.getDefaultEntry())," ",u]})]})]}),(0,M.jsx)(ie.Z,{mt:"24px",mx:"5px",children:D}),R?(0,M.jsx)(ie.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:"2px"},children:(0,M.jsx)(x.Z,{component:"div",variant:"caption1",color:"magenta.500",children:o.formatMessage(R,xt()(R))})}):null]})})}},r()(Lt,"contextTypes",{intl:d.intlShape.isRequired}),Pt=Lt,Bt=yt()(Pt.prototype,"spendingPasswordForm",[vt.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt()(Pt.prototype,"setSpendingPasswordForm",[vt.action],ut()(Pt.prototype,"setSpendingPasswordForm"),Pt.prototype),Et=Pt))||Et;var _t,Ft;let zt=(0,n.Pi)((Ft=class extends l.Component{constructor(...e){super(...e),r()(this,"state",{govStatusFetched:!1}),r()(this,"onClose",(()=>{this.props.actions.dialogs.closeActiveDialog.trigger()})),r()(this,"getEpochLengthInDays",(e=>{const t=this.props.stores.substores.ada.time.getTimeCalcRequests(e),{currentEpochLength:o,currentSlotLength:a}=t.requests;return o()*a()/86400})),r()(this,"createWithdrawalTx",(e=>{const t=this.props.stores.wallets.selected;if(null==t)throw new Error("StakingPageContent no public deriver. Should never happen");this.props.actions.ada.delegationTransaction.setShouldDeregister.trigger(e);const{delegationTransaction:o}=this.props.actions.ada;o.createWithdrawalTxForWallet.trigger({wallet:t}),this.props.actions.dialogs.open.trigger({dialog:Ot})})),r()(this,"getStakePoolMeta",(e=>{var t,o,a,r,n;const s=this.props.stores.delegation,i=s.getDelegatedPoolId(e.publicDeriverId);if(null==i)return null;const l=s.getLocalPoolInfo(e.networkId,i),{stake:d,roa:c,saturation:p,pic:h}=null!==(t=s.getLocalRemotePoolInfo(e.networkId,i))&&void 0!==t?t:{};if(null==l)return null;const{intl:u}=this.context,g=null!==(o=null===(a=l.info)||void 0===a?void 0:a.name)&&void 0!==o?o:u.formatMessage(f.default.unknownPoolLabel),x={id:String(i),name:g,avatar:h,roa:(0,Ge.maybe)(c,(0,Ge.compose)(Number,Q.roundTwoDecimal)),poolSize:(0,Ge.maybe)(d,Q.formatLovelacesHumanReadableShort),share:(0,Ge.maybe)(p,(e=>(0,Q.roundOneDecimal)(100*Number(e)))),websiteUrl:null===(r=l.info)||void 0===r?void 0:r.homepage,ticker:null===(n=l.info)||void 0===n?void 0:n.ticker};return(0,M.jsx)(T,{poolTransition:s.getPoolTransitionInfo(e),delegatedPool:x,undelegate:async()=>this.createWithdrawalTx(!0),delegateToSpecificPool:async e=>{if(null!=e)return this.props.stores.delegation.createDelegationTransaction(e)}})})),r()(this,"getEpochProgress",(e=>{const t=this.props.stores.substores.ada.time.getTimeCalcRequests(e),{toAbsoluteSlot:o,toRealTime:a,currentEpochLength:r}=t.requests,n=this.props.stores.substores.ada.time.getCurrentTimeRequests(e),s=n.currentEpoch,l=r(),d=(e,t=!1)=>{const r=a({absoluteSlotNum:o({epoch:e,slot:l})});return t?r:i()(r).format("lll")},c=d(s),p=d(s,!0),h=d(s-1);return(0,M.jsx)(_,{epochProgress:{startEpochDate:h,currentEpoch:s,endEpochDate:c,endEpochDateTime:p,percentage:Math.floor(100*n.currentSlot/l)}})})),r()(this,"toUnitOfAccount",(e=>{var t;const{stores:o}=this.props,a=null===(t=o.tokenInfoStore.tokenInfo.get(e.networkId.toString()))||void 0===t?void 0:t.get(e.identifier);if(null==a)return;if(!o.profile.unitOfAccount.enabled)return;const r=o.profile.unitOfAccount.currency,n=e.amount.shiftedBy(-a.Metadata.numberOfDecimals),s=a.Metadata.ticker;if(null==s)throw new Error("unexpected main token type");const i=o.coinPriceStore.getCurrentPrice(s,r);return null==i?{currency:r,amount:"-"}:{currency:r,amount:(0,Je.calculateAndFormatValue)(n,i)}}))}async componentDidMount(){const e=this.props.stores.wallets.selected;if(null==e)throw new Error("StakingPageContent no public deriver. Should never happen");if(this.props.stores.delegation.checkGovernanceStatus(e).then((()=>(this.setState({govStatusFetched:!0}),null))).catch((e=>{console.error("Failed to fetch governance status",e)})),this.props.stores.delegation.getPoolTransitionConfig(e).shouldUpdatePool){const t=this.props.stores.delegation.getPoolTransitionInfo(e);null!=t&&t.suggestedPool&&(0,Ge.noop)(this.props.stores.delegation.createDelegationTransaction(t.suggestedPool.hash))}}render(){var e;const t=this.props.stores.wallets.selected;if(null==t)throw new Error("StakingPageContent no public deriver. Should never happen");const{actions:o,stores:a}=this.props,{uiDialogs:r,delegation:n}=a,s=n.getDelegationRequests(t.publicDeriverId);if(null==s)throw new Error("StakingPageContent opened for non-reward wallet");const i=t.balance,l=null!=i&&i.getDefaultEntry().amount.isZero(),d=(0,Ge.maybe)(s.error,(e=>({error:e}))),c=null==d&&a.delegation.isExecutedDelegatedBalance(t.publicDeriverId),h=a.delegation.isStakeRegistered(t.publicDeriverId),g=a.delegation.isCurrentlyDelegating(t.publicDeriverId),x=a.delegation.getDelegatedUtxoBalance(t.publicDeriverId),m=a.delegation.getRewardBalanceOrZero(t),f=null!=(null===(e=a.delegation.governanceStatus)||void 0===e?void 0:e.drepDelegation);return(0,M.jsxs)(p.Z,{children:[l?(0,M.jsx)(at.Z,{onBuySellClick:()=>this.props.actions.dialogs.open.trigger({dialog:u.default})}):null,g?(0,M.jsxs)(Nt,{children:[(0,M.jsx)(Ye,{onOverviewClick:()=>o.dialogs.open.trigger({dialog:J}),withdrawRewards:h&&this.state.govStatusFetched?async()=>{f?this.createWithdrawalTx(!1):this.props.actions.dialogs.open.trigger({dialog:it})}:void 0,unitOfAccount:this.toUnitOfAccount,getTokenInfo:(0,V.genLookupOrFail)(a.tokenInfoStore.tokenInfo),shouldHideBalance:a.profile.shouldHideBalance,totalRewards:c?m:void 0,totalDelegated:(()=>{if(c)return g?(0,Ge.maybe)(x,(e=>m.joinAddCopy(e))):new G.a([],t.balance.getDefaults())})(),graphData:(0,Xe.K)({delegationRequests:s,currentEpoch:a.substores.ada.time.getCurrentTimeRequests(t).currentEpoch,shouldHideBalance:a.profile.shouldHideBalance,getLocalPoolInfo:a.delegation.getLocalPoolInfo,tokenInfo:a.tokenInfoStore.tokenInfo,networkId:t.networkId,defaultTokenId:t.defaultTokenId}),onOpenRewardList:()=>o.dialogs.open.trigger({dialog:be})}),(0,M.jsxs)(qt,{children:[!d&&this.getStakePoolMeta(t),!d&&this.getEpochProgress(t)]})]}):null,(0,M.jsx)(pt.default,{stores:this.props.stores,actions:this.props.actions,urlTemplate:"https://adapools.yoroiwallet.com/?source=$$BROWSER$$",poolTransition:n.getPoolTransitionInfo(t)}),r.isOpen(J)?(0,M.jsx)(J,{onClose:this.onClose,getTokenInfo:(0,V.genLookupOrFail)(this.props.stores.tokenInfoStore.tokenInfo),totalRewards:c?m:void 0,shouldHideBalance:this.props.stores.profile.shouldHideBalance,unitOfAccount:this.toUnitOfAccount,withdrawRewards:!1===f||h?()=>{this.props.actions.dialogs.open.trigger({dialog:it})}:void 0}):null,r.isOpen(et.Z)?(0,M.jsx)(et.Z,{actions:o,stores:a,alwaysShowDeregister:!0,onNext:()=>{const{delegationTransaction:e}=this.props.actions.ada;e.createWithdrawalTxForWallet.trigger({wallet:t}),this.props.actions.dialogs.open.trigger({dialog:Ot})}}):null,r.isOpen(it)?(0,M.jsx)(it,{actions:o,onClose:this.onClose,intl:this.context.intl}):null,r.isOpen(tt.Z)?(0,M.jsx)(tt.Z,{actions:o,stores:a,onClose:this.onClose}):null,r.isOpen(ot.Z)?(0,M.jsx)(ot.Z,{actions:o,stores:a,onClose:()=>{this.props.actions.ada.delegationTransaction.reset.trigger({justTransaction:!1}),this.props.actions.dialogs.closeActiveDialog.trigger()}}):null,r.isOpen(Ot)?(0,M.jsx)(Ot,{actions:o,stores:a,onClose:()=>{this.props.actions.ada.delegationTransaction.reset.trigger({justTransaction:!1}),this.props.actions.dialogs.closeActiveDialog.trigger()}}):null,r.isOpen(be)?(0,M.jsx)(be,{onClose:this.onClose,graphData:(0,Xe.K)({delegationRequests:s,currentEpoch:a.substores.ada.time.getCurrentTimeRequests(t).currentEpoch,shouldHideBalance:a.profile.shouldHideBalance,getLocalPoolInfo:a.delegation.getLocalPoolInfo,tokenInfo:a.tokenInfoStore.tokenInfo,networkId:t.networkId,defaultTokenId:t.defaultTokenId})}):null]})}},r()(Ft,"contextTypes",{intl:d.intlShape.isRequired}),_t=Ft))||_t;const Ht=(0,c.XC)(zt),Nt=(0,h.Z)(p.Z)({display:"flex",gap:"24px",justifyContent:"space-between",marginBottom:"40px"}),qt=(0,h.Z)(p.Z)({display:"flex",flex:"1 1 48.5%",maxWidth:"48.5%",flexDirection:"column",gap:"24px"})}}]);